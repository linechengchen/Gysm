
<!DOCTYPE html>
<html>
<head>
	
	<base href="https://auth.qtshe.com:80/"/>
	<meta charset="UTF-8"/>
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
	<title></title>
	
<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!-->  <!--<![endif]-->
<html>
<head>
	
	<base href="https://auth.qtshe.com:80/"/>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <meta name="viewport"
	content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <meta content="" name="description"/>
    <meta content="" name="author"/>
    <!-- BEGIN GLOBAL MANDATORY STYLES -->
	<script type="text/javascript" src="https://7xiyzi.com2.z0.glb.qiniucdn.com/jquery.min.js"></script>	
	<script type="text/javascript" src="https://7xiyzi.com2.z0.glb.qiniucdn.com/jquery.cookie.js"></script>
	<script type="text/javascript" src="https://7xiyzi.com2.z0.glb.qiniucdn.com/artTemplate.js"></script>
	<script type="text/javascript" src="https://7xiyzi.com2.z0.glb.qiniucdn.com/qtshe-app.js"></script>
	
	<script type="text/javascript" src="/resources/script/authUtil.js" ></script>
	<script type="text/javascript" src="/resources/script/localStorage.js" ></script>
	<link rel = "Shortcut Icon" href="https://7xiyzg.com2.z0.glb.qiniucdn.com/logo.ico">
	<link rel="stylesheet" href="../resources/css/realname.css">
	<link rel="stylesheet" href="../resources/css/qtb.css">
	<script type="text/javascript">
	function displayHead() {		//是否隐藏头部
		if (isAndroid) {
			try { 
				window.android.displayHead(false);
			} catch (e) { }
		} else if(isIos()) {
			connectWebViewJavascriptBridge(function(bridge) {
				bridge.callHandler('displayHead', {display:false}, function(response) {
					console.log(response);
				})
			});
		}
	}
	displayHead();
	</script>
</head>
<body>
</body>
</html>
	<script type="text/javascript" src="https://7xiyzi.com2.z0.glb.qiniucdn.com/jquery-form .js"></script>
	<script type="text/javascript" src="https://7xiyzi.com2.z0.glb.qiniucdn.com/uploadPreview.min.js"></script>
	<script>
	
	// 是否是ios浏览器

		function isIos() {
			var u = navigator.userAgent, app = navigator.appVersion;
			var isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端
			return isiOS;
		}
	
		// 判断是android浏览器
		function isAndroid() {
			var u = navigator.userAgent, app = navigator.appVersion;
			var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Linux') > -1;
			return isAndroid;
		}

		function connectWebViewJavascriptBridge(callback) {
				if (window.WebViewJavascriptBridge) {
					callback(WebViewJavascriptBridge);
				} else {
					document.addEventListener('WebViewJavascriptBridgeReady', function() {
						callback(WebViewJavascriptBridge);
					}, false);
				}
		}
		
		nativeUp();
		function nativeUp() {
			
			if (isAndroid) {
				
				window.android.realNameAuth("string");	
			
			} else if(isIos()) {
				
				connectWebViewJavascriptBridge(function(bridge) {
					
					bridge.callHandler('realNameAuth', {}, function(data, responseCallback) {
						responseCallback({});
					});
				});
			}
		}
	
	</script>
	
</head>
<body>
	<input type="hidden" id="jumpurl" value="">
	<div class="real-name-auto">
		<!-- 头部 -->
		<header>
			<a href="javascript:window.history.go(-1);" class="header_btn_left_back btn_back"></a>
			实名认证
		</header>
		<!-- 身体部分 -->
		<div class="body">
			<div class="height16"></div>
			<form id="realNameForm" enctype="multipart/form-data">
				<div class="apply-content">
				</div>
			</form>
<!-- value="{{data.identityCardNO}}" -->

			<script type="text/html" id="applySuccess">
				<div class="apply-success">
					
						<div class="height30"></div>
						<div class="height16"></div>
						<img class="apply-success-img" src="resources/imgs/renzheng@3x.png">
						<div class="apply-success-title">
							您已通过实名认证
						</div>
						
						<div class="height16"></div>
						
					</div>
					
					<div class="height16"></div>

					<!-- 身份证 -->
					<ul class="ul-idcard">
						<li>
							<div class="ul-idcard-font">真实姓名</div>
							<div class="ul-idcard-div">
								<input class="ul-idcard-div-input" type="text" placeholder="请输入您的真实姓名" value="{{data.name}}" id="name">
							</div>	
						</li>
						<li>
							<div class="ul-idcard-font">身份证号</div>
							<div class="ul-idcard-div">
								<input class="ul-idcard-div-input" type="text" placeholder="请输入您的身份证号码" onkeyup="this.value=this.value.replace(/\D/g,'')" maxlength="18"  id="identityCardNO">
							</div>
						</li>
					</ul>
					
					<div class="height16"></div>
					
					<!-- 状态 -->
					<ul class="ul-idcard">
						<li>
							<div class="ul-idcard-font">审核状态</div>
							<div class="ul-idcard-div">
								<div class="ul-idcard-div-title">
									{{if data.status == 'NOT_SUBMIT'}}
										未提交
									{{/if}}
									{{if data.status == 'AUTHENTICATING'}}
										正在审核
									{{/if}}
									{{if data.status == 'SUCCESS'}}
										认证成功
									{{/if}}
									{{if data.status == 'FAIL'}}
										认证失败
									{{/if}}
								</div>
							</div>	
						</li>
					</ul>
			</script>
			
			
			<script type="text/html" id="applyAuto">
				<!-- 身份证照片 -->
				<ul class="ul-img-show">
					<li>
						{{if data.status == 'AUTHENTICATING'}}
							<li>
								<div id="identityCardFrontDiv" class=" img-file-div">
									<img id="identityCardFrontImg" class="ul-img-show-img img-file-div-img" 
										src="{{data.identityCardFront == null?'resources/imgs/idcard-zheng.png':data.identityCardFront.identityCardFrontMax}}">
									<input id="identityCardFrontFile" class="ul-img-show-input img-file-div-input" type="file" name="identityCardFront">
									<input type="hidden"  id="identityCardFrontUrl" value="{{data.identityCardFront == null?'':data.identityCardFront.identityCardFrontMax}}">
								</div>
								<p class="ul-img-show-font">身份证正面</p>
							</li>
							<li>
								<div id="identityCardBackDiv" class=" img-file-div">
									<img id="identityCardBackImg" class="ul-img-show-img img-file-div-img" 
									src="{{data.identityCardBack == null?'resources/imgs/idcard-fan.png':data.identityCardBack.identityCardBackMax}}">
									<input id="identityCardBackFile" class="ul-img-show-input img-file-div-input" type="file" name="identityCardBack">
									<input type="hidden" id="identityCardBackUrl" value="{{data.identityCardBack == null?'':data.identityCardBack.identityCardBackMax}}">
								</div>
								<p class="ul-img-show-font">身份证反面</p>
							</li>
						{{/if}}
						{{if data.status != 'AUTHENTICATING'}}
							<div id="identityCardFrontDiv" class=" img-file-div">
								<img id="identityCardFrontImg" class="ul-img-show-img img-file-div-img" 
									src="resources/imgs/idcard-zheng.png">
								<input id="identityCardFrontFile" class="ul-img-show-input img-file-div-input" type="file" name="identityCardFront">
								<input type="hidden"  id="identityCardFrontUrl">
							</div>
							<p class="ul-img-show-font">身份证正面</p>
						</li>
						<li>
							<div id="identityCardBackDiv" class=" img-file-div">
								<img id="identityCardBackImg" class="ul-img-show-img img-file-div-img" 
								src="resources/imgs/idcard-fan.png">
								<input id="identityCardBackFile" class="ul-img-show-input img-file-div-input" type="file" name="identityCardBack">
								<input type="hidden" id="identityCardBackUrl">
							</div>
							<p class="ul-img-show-font">身份证反面</p>
						</li>
						{{/if}}
				</ul>
				<div class="cb"></div>
				
				<div class="height16"></div>
				
				<!-- 身份证 -->
				<ul class="ul-idcard">
					<li>
						<div class="ul-idcard-font">真实姓名</div>
						<div class="ul-idcard-div">
							<input class="ul-idcard-div-input" type="text" placeholder="请输入您的真实姓名" value="{{data.name}}" id="name">
						</div>	
					</li>
					<li>
						<div class="ul-idcard-font">身份证号</div>
						<div class="ul-idcard-div">
							<input class="ul-idcard-div-input" type="text" placeholder="请输入您的身份证号码"  maxlength="18" value="{{if data.status == 'AUTHENTICATING'}}{{data.identityCardNO}}{{/if}}" id="identityCardNO">
						</div>
					</li>
				</ul>
				
				<div class="height16"></div>
				
				<!-- 状态 -->
				<ul class="ul-idcard">
					<li>
						<div class="ul-idcard-font">审核状态</div>
						<div class="ul-idcard-div">
							<div class="ul-idcard-div-title">
								{{if data.status == 'NOT_SUBMIT'}}
									未提交
								{{/if}}
								{{if data.status == 'AUTHENTICATING'}}
									正在审核
								{{/if}}
								{{if data.status == 'SUCCESS'}}
									认证成功
								{{/if}}
								{{if data.status == 'FAIL'}}
									认证失败
								{{/if}}
							</div>
						</div>	
					</li>
				</ul>
	
				<div class="height16"></div>
				<input type="hidden" name="userAuthenticateId" id="userAuthenticateId" value="{{data.userAuthenticateId}}">
				<!-- 按钮 -->
				{{if data.status == 'NOT_SUBMIT'}}
					<div class="btn-div">
						<button class="btn-div-button" type="button" onclick="addOauth()">提交审核</button>
					</div>
				{{/if}}
				{{if data.status == 'AUTHENTICATING'}}
					<div class="btn-div">
						<button class="btn-div-button" type="button">正在认证...</button>
					</div>
				{{/if}}
				{{if data.status == 'SUCCESS'}}
					<div class="btn-div">
						<button class="btn-div-button" type="button">认证成功</button>
					</div>
				{{/if}}
				{{if data.status == 'FAIL'}}
					<div class="btn-div">
						<button class="btn-div-button" onclick="changeOauth()" type="button">重新提交</button>
					</div>
				{{/if}}
			</div>
			</script>
			<div class="auto-title">注：实名认证仅使用在爱帮兼职工资提现上</div>
			
			<div class="height16"></div>
						
		</div>

	</div>
	
<!DOCTYPE>
<html>
<head>
	
	<base href="https://auth.qtshe.com:80/"/>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Insert title here</title>

<style>
.loading-model {
	position: fixed;
	width: 100%;
	height: 100%;
	top:0px;
	left:0px;
	background-color: #000;
    filter:alpha(opacity=50);  
    -moz-opacity:0.5;  
    -khtml-opacity: 0.5;  
    opacity: 0.5;
    display: none;
    z-index: 10000000;
}

.spinner {
  margin: 250px auto;
  width: 150px;
  height: 150px;
  position: relative;
}
 
.container1 > div, .container2 > div, .container3 > div {
  width: 40px;
  height: 40px;
  background-color: green;
 
  border-radius: 100%;
  position: absolute;
  -webkit-animation: bouncedelay 1.2s infinite ease-in-out;
  animation: bouncedelay 1.2s infinite ease-in-out;
  -webkit-animation-fill-mode: both;
  animation-fill-mode: both;
}
 
.spinner .spinner-container {
  position: absolute;
  width: 100%;
  height: 100%;
}
 
.container2 {
  -webkit-transform: rotateZ(45deg);
  transform: rotateZ(45deg);
}
 
.container3 {
  -webkit-transform: rotateZ(90deg);
  transform: rotateZ(90deg);
}
 
.circle1 { top: 0; left: 0; }
.circle2 { top: 0; right: 0; }
.circle3 { right: 0; bottom: 0; }
.circle4 { left: 0; bottom: 0; }
 
.container2 .circle1 {
  -webkit-animation-delay: -1.1s;
  animation-delay: -1.1s;
}
 
.container3 .circle1 {
  -webkit-animation-delay: -1.0s;
  animation-delay: -1.0s;
}
 
.container1 .circle2 {
  -webkit-animation-delay: -0.9s;
  animation-delay: -0.9s;
}
 
.container2 .circle2 {
  -webkit-animation-delay: -0.8s;
  animation-delay: -0.8s;
}
 
.container3 .circle2 {
  -webkit-animation-delay: -0.7s;
  animation-delay: -0.7s;
}
 
.container1 .circle3 {
  -webkit-animation-delay: -0.6s;
  animation-delay: -0.6s;
}
 
.container2 .circle3 {
  -webkit-animation-delay: -0.5s;
  animation-delay: -0.5s;
}
 
.container3 .circle3 {
  -webkit-animation-delay: -0.4s;
  animation-delay: -0.4s;
}
 
.container1 .circle4 {
  -webkit-animation-delay: -0.3s;
  animation-delay: -0.3s;
}
 
.container2 .circle4 {
  -webkit-animation-delay: -0.2s;
  animation-delay: -0.2s;
}
 
.container3 .circle4 {
  -webkit-animation-delay: -0.1s;
  animation-delay: -0.1s;
}
 
@-webkit-keyframes bouncedelay {
  0%, 80%, 100% { -webkit-transform: scale(0.0) }
  40% { -webkit-transform: scale(1.0) }
}
 
@keyframes bouncedelay {
  0%, 80%, 100% {
    transform: scale(0.0);
    -webkit-transform: scale(0.0);
  } 40% {
    transform: scale(1.0);
    -webkit-transform: scale(1.0);
  }
}
</style>

</head>
<body>
<div class="loading-model">
	<div class="spinner">
	  <div class="spinner-container container1">
	    <div class="circle1"></div>
	    <div class="circle2"></div>
	    <div class="circle3"></div>
	    <div class="circle4"></div>
	  </div>
	  <div class="spinner-container container2">
	    <div class="circle1"></div>
	    <div class="circle2"></div>
	    <div class="circle3"></div>
	    <div class="circle4"></div>
	  </div>
	  <div class="spinner-container container3">
	    <div class="circle1"></div>
	    <div class="circle2"></div>
	    <div class="circle3"></div>
	    <div class="circle4"></div>
	  </div>
	</div>
</div>
</body>
</html>
	<script type="text/javascript">
	
		queryOauth();
		
		// 查询报名状态
		function queryOauth () {
			showLoading();
			var data = {};
			data = fillParam(data);
			$.ajax({
				type:"post",
				url:"local/auth/oauth/info",
				data:data,
				dataType:"json",
				success:function(data) {
					console.log(data);
					if(data.success) {
						if(data.data.status != 'SUCCESS') {
							$(".apply-content").html(template('applyAuto',data));
							new uploadPreview({UpBtn: "identityCardFrontFile", DivShow:"identityCardFrontDiv",ImgShow:"identityCardFrontImg"});
							new uploadPreview({UpBtn: "identityCardBackFile", DivShow:"identityCardBackDiv",ImgShow:"identityCardBackImg"});
						} else {
							$(".apply-content").html(template('applySuccess',data));
						}
						if(data.data.status == 'AUTHENTICATING' || data.data.status == 'SUCCESS') {
							var jumpurl = $("#jumpurl").val();
							if(!isEmpty(jumpurl)) {
								jumpurlTime(jumpurl,3000);
							}
						}
						
					} else {
						alert(data.errMsg);
					}
					hideLoading();
				},
				error:function(){
					alert("网络出错");
					hideLoading();
				}
			});
		}
		
		// 提交实名认证
		function addOauth() {
		
			var data = {};
			data.name = $("#name").val(); 
			data.identityCardNO = $("#identityCardNO").val();
			
			data.identityCardFront = $("#identityCardFrontFile").val();
			data.identityCardBack =	$("#identityCardBackFile").val();
			data.authenticateId = $("#userAuthenticateId").val();
			
			if(isEmpty(data.name)) {
				alert("请输入姓名");
			} else if (isEmpty(data.identityCardNO)) {
				alert("请输入身份证号码");
			} else if (data.identityCardNO.length != 18) {
				alert("身份证号码位数不对");
			} else if (isEmpty(data.identityCardFront)) {
				alert("请上传身份证正面照");
			} else if (isEmpty(data.identityCardBack)) {
				alert("请上传身份证背面照");
			} else {
				showLoading();
				data = fillParam(data);
				$("#realNameForm").ajaxSubmit({
			        type:"post", // 提交方式 get/post
			        url:"local/auth/oauth/add", // 需要提交的 url
			        data: data,
			        dataType:"json",
			        success: function(data) { // data 保存提交后返回的数据，一般为 json 数据
			        	if(data.success) {
							queryOauth();
						} else {
							alert(data.errMsg);
							hideLoading();
						}
			        },
			        error:function(){
			        	alert("提交失败");
			        	hideLoading();
			       }});
				  return false; // 阻止表单自动提交事件
			}
		}
		
		// 修改实名认证
		function changeOauth() {	
			var data = {};
			data.name = $("#name").val(); 
			data.identityCardNO = $("#identityCardNO").val();
			if(!isEmpty($("#identityCardFrontFile").attr("value"))) {
				data.identityCardFront = $("#identityCardFrontFile").attr("value");
			}
			if(!isEmpty($("#identityCardBackFile").attr("value"))) {
				data.identityCardBack =	$("#identityCardBackFile").attr("value");
			}
			
			data.identityCardFrontUrl = $("#identityCardFrontUrl").val();
			data.identityCardBackUrl =	$("#identityCardBackUrl").val();
			data.authenticateId = $("#userAuthenticateId").val();
			
			if(isEmpty(data.name)) {
				alert("请输入姓名");
			} else if (isEmpty(data.identityCardNO)) {
				alert("请输入身份证号码");
			} else if (data.identityCardNO.length != 18) {
				alert("身份证号码位数不对");
			} else {
				showLoading();
				data = fillParam(data);
				console.log(data);
				$("#realNameForm").ajaxSubmit({
			        type:"post", // 提交方式 get/post
			        url:"local/auth/oauth/update", // 需要提交的 url
			        data: data,
			        dataType:"json",
			        success: function(data) { // data 保存提交后返回的数据，一般为 json 数据
			        	if(data.success) {
							queryOauth();		
							
							var jumpurl = $("#jumpurl").val();
							if(!isEmpty(jumpurl)) {
								jumpurlTime(jumpurl,3000);
							}
						} else {
							alert(data.errMsg);
							hideLoading();
						}
			        },
			        error:function(){
			        	alert("提交失败");
			        	hideLoading();
			       }});
				  return false; // 阻止表单自动提交事件
				  
			}
		}
		
	</script>
	
</body>
</html>